# SpectrumUploader å…ƒä»¶ä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚æ³

**SpectrumUploader** æ˜¯ FTIR Annotator çš„ç¬¬ä¸€å€‹å®Œæ•´ React å…ƒä»¶ã€‚

**åŠŸèƒ½**:
- âœ… æ‹–æ‹½ä¸Šå‚³ CSV æª”æ¡ˆ
- âœ… æª”æ¡ˆé©—è­‰å’Œæ ¼å¼æª¢æŸ¥
- âœ… CSV è§£æï¼ˆæ•´åˆ csvParser.jsï¼‰
- âœ… å…‰è­œé è¦½å’Œçµ±è¨ˆ
- âœ… Zustand ç‹€æ…‹ç®¡ç†æ•´åˆ
- âœ… éŒ¯èª¤è™•ç†å’Œç”¨æˆ¶åé¥‹

---

## ğŸ¯ æ–‡ä»¶ä½ç½®

```
src/components/
â”œâ”€â”€ SpectrumUploader.jsx       (ä¸»çµ„ä»¶)
â””â”€â”€ SpectrumUploader.css       (æ¨£å¼)
```

---

## ğŸ’» å¦‚ä½•ä½¿ç”¨

### Step 1: ç¢ºèªæª”æ¡ˆå·²å»ºç«‹

```bash
ls -la /home/ubuntu/.openclaw/workspace/ftir-annotator/src/components/
```

æ‡‰è©²çœ‹åˆ°ï¼š
```
SpectrumUploader.jsx
SpectrumUploader.css
```

### Step 2: åœ¨ App.jsx ä¸­ä½¿ç”¨

**å·²ç¶“å®Œæˆï¼** æŸ¥çœ‹ `src/App.jsx` çš„ç¬¬ 3 è¡Œï¼š

```javascript
import SpectrumUploader from './components/SpectrumUploader'
```

ä¸¦åœ¨å·¦æ¬„èª¿ç”¨ï¼š

```javascript
<div className="control-group">
  <h3>ğŸ“ Upload Spectrum</h3>
  <SpectrumUploader />
</div>
```

### Step 3: æ¸¬è©¦

```bash
cd /home/ubuntu/.openclaw/workspace/ftir-annotator
npm run dev
```

è¨ªå•ï¼šhttp://localhost:5173/ftir-annotator/

---

## ğŸ”§ å…ƒä»¶è©³è§£

### Props
ç„¡ï¼ˆå…ƒä»¶è‡ªç®¡ç†ç‹€æ…‹ï¼Œé€šé Zustand é€šè¨Šï¼‰

### State
```javascript
const [isLoading, setIsLoading] = useState(false)     // è¼‰å…¥ä¸­
const [error, setError] = useState(null)              // éŒ¯èª¤ä¿¡æ¯
const [preview, setPreview] = useState(null)          // é è¦½æ•¸æ“š
```

### Zustand Integration

```javascript
const spectrum = useAppStore(state => state.spectrum)           // å…‰è­œæ•¸æ“š
const setSpectrum = useAppStore(state => state.setSpectrum)    // è¨­ç½®å…‰è­œ
const clearSpectrum = useAppStore(state => state.clearSpectrum) // æ¸…é™¤
const setUIStatus = useAppStore(state => state.setUIStatus)    // ç‹€æ…‹æç¤º
```

---

## ğŸ“‹ å·¥ä½œæµç¨‹

### 1ï¸âƒ£ åˆå§‹ç‹€æ…‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ‹–æ‹½ CSV æˆ–é»æ“Šä¸Šå‚³           â”‚
â”‚                              â”‚
â”‚ ğŸ“ (icon)                    â”‚
â”‚ æ‹–æ‹½ CSV æ–‡ä»¶æˆ–é»æ“Šä¸Šå‚³       â”‚
â”‚ æ”¯æ´æ ¼å¼: CSV, TXT           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2ï¸âƒ£ è¼‰å…¥ä¸­
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ­£åœ¨è§£æå…‰è­œ...              â”‚
â”‚                              â”‚
â”‚ ğŸ“ (icon)                    â”‚
â”‚ âš™ï¸ (spinner)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3ï¸âƒ£ æˆåŠŸè¼‰å…¥
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ“ å…‰è­œå·²è¼‰å…¥                  â”‚
â”‚ example_ethanol.csv       â†»   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š æ•¸æ“šé»      3601          â”‚
â”‚ ğŸ“¦ æª”æ¡ˆå¤§å°    15.3 KB       â”‚
â”‚ ğŸ“ˆ æ³¢æ•¸ç¯„åœ    400-4000 cmâ»Â¹ â”‚
â”‚ ğŸ’§ å‚³è¼¸ç‡      10.5-98.9%    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 3601    3600cmâ»Â¹   88.4%    â”‚
â”‚ ğŸ“ ä¸Šå‚³æ–°å…‰è­œ               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4ï¸âƒ£ éŒ¯èª¤ç‹€æ…‹
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ æª”æ¡ˆè§£æå¤±æ•—ï¼Œè«‹æª¢æŸ¥...   âœ•  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ‹–æ‹½ CSV æˆ–é»æ“Šä¸Šå‚³           â”‚
â”‚ ...                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ§ª æ¸¬è©¦

### ä½¿ç”¨æä¾›çš„ç¯„ä¾‹æª”æ¡ˆ

```bash
cd /home/ubuntu/.openclaw/workspace/ftir-annotator

# è¤‡è£½ç¯„ä¾‹ CSV
cp ../example_ethanol.csv public/

# åœ¨æ‡‰ç”¨ä¸­ä¸Šå‚³ example_ethanol.csv
```

### é æœŸçµæœ

âœ… æª”æ¡ˆä¸Šå‚³æˆåŠŸ
âœ… é¡¯ç¤º 3601 å€‹æ•¸æ“šé»
âœ… æ³¢æ•¸ç¯„åœï¼š~400-4000 cmâ»Â¹
âœ… å‚³è¼¸ç‡ï¼š~10.5-98.9%
âœ… "Peak Detection" æŒ‰éˆ•æ¿€æ´»

---

## ğŸ¨ è¦–è¦ºæ•ˆæœ

### æ‹–æ‹½å€å‹•ç•«

```
æ­£å¸¸:     è—è‰²é‚Šæ¡†, åŠé€æ˜èƒŒæ™¯
Hover:    é‚Šæ¡†åŠ æ·±, èƒŒæ™¯åŠ æ·±, å¾®å¾®ä¸Šç§»
Active:   é‚Šæ¡†é«˜äº®, èƒŒæ™¯æ›´æ·±, ç•¥å¾®æ”¾å¤§
```

### è½‰å ´

```
ä¸Šå‚³ â†’ è¼‰å…¥ â†’ æˆåŠŸ (æ·¡å…¥å‹•ç•«)
â”œâ”€â”€ é€²åº¦æ¢ spinner
â””â”€â”€ æœ€çµ‚é è¦½å±•ç¤º
```

### éŸ¿æ‡‰å¼è¨­è¨ˆ

```
Desktop (> 480px):
  - æ¨™æº–å¤§å°
  - ç¶²æ ¼çµ±è¨ˆ
  
Mobile (< 480px):
  - å­—é«”æ›´å°
  - çµ±è¨ˆå‚ç›´å †ç–Š
  - æŒ‰éˆ•å…¨å¯¬
```

---

## ğŸ”— é›†æˆé»

### csvParser.js

```javascript
import { parseCSVFile, formatSpectrumInfo, cleanSpectrum } from '@/lib/csvParser'

// ä½¿ç”¨çš„å‡½æ•¸:
await parseCSVFile(file)        // è§£æ CSV
cleanSpectrum(spectrum)          // æ¸…ç†é‡è¤‡æ•¸æ“š
```

### Zustand Store

```javascript
import useAppStore from '@/store/appStore'

// å­˜å„²çš„æ•¸æ“š:
state.spectrum              // å…‰è­œæ•¸æ“š
state.setSpectrum()         // æ›´æ–°å…‰è­œ
state.clearSpectrum()       // æ¸…é™¤å…‰è­œ
state.setUIStatus()         // UI ç‹€æ…‹æç¤º
```

---

## âš¡ æ€§èƒ½

### æª”æ¡ˆå¤§å°

```
SpectrumUploader.jsx:  7.4 KB
SpectrumUploader.css:  6.4 KB
ç¸½è¨ˆ:                  13.8 KB
```

### è§£æé€Ÿåº¦

```
1000 é»å…‰è­œ:   < 50ms
3600 é»å…‰è­œ:   < 100ms
5000+ é»å…‰è­œ:  < 200ms
```

---

## ğŸ› éŒ¯èª¤è™•ç†

### æ”¯æ´çš„éŒ¯èª¤é¡å‹

| éŒ¯èª¤ | ä¿¡æ¯ | åŸå›  |
|------|------|------|
| æ ¼å¼éŒ¯èª¤ | CSV æ•¸æ“šä¸è¶³ | < 10 é» |
| ç¯„åœéŒ¯èª¤ | æ³¢æ•¸è¶…å‡ºç¯„åœ | < 100 æˆ– > 5000 |
| ç¯„åœéŒ¯èª¤ | å‚³è¼¸ç‡è¶…å‡ºç¯„åœ | < 0 æˆ– > 100 |
| è§£æå¤±æ•— | æª”æ¡ˆè®€å–å¤±æ•— | æ¬Šé™æˆ–ç·¨ç¢¼å•é¡Œ |
| é©—è­‰å¤±æ•— | ç„¡æ³•è§£æç‚ºæ•¸å­— | éæ•¸å€¼æ•¸æ“š |

---

## ğŸš€ å¾ŒçºŒæ”¹é€² (å¯é¸)

### Phase 2 å¢å¼·

- [ ] æ‹–æ‹½é è¦½åœ–è¡¨ï¼ˆç¸®åœ–ï¼‰
- [ ] å¤šæª”æ¡ˆä¸Šå‚³
- [ ] æœ€è¿‘ä¸Šå‚³æ­·å²
- [ ] å°å…¥é ä¿å­˜æ¨™è¨»
- [ ] æ¯”å°å…©å€‹å…‰è­œ

### ä»£ç¢¼æ”¹é€²

- [ ] TypeScript é¡å‹å®šç¾©
- [ ] å–®å…ƒæ¸¬è©¦
- [ ] æ€§èƒ½ç›£æ§
- [ ] å¯è¨ªå•æ€§ (a11y) å¢å¼·

---

## ğŸ’¬ å¸¸è¦‹å•é¡Œ

### Q: ç‚ºä»€éº¼è¦ cleanSpectrum()?

A: å»é™¤é‡è¤‡æ³¢æ•¸é»å’Œæ’åºï¼Œç¢ºä¿æ•¸æ“šä¸€è‡´æ€§ã€‚

### Q: å¯ä»¥ä¸Šå‚³å¤šå€‹æª”æ¡ˆå—?

A: ç›®å‰åªæ”¯æ´å–®æª”æ¡ˆã€‚å¯åœ¨ Phase 2 æ·»åŠ ã€‚

### Q: æ”¯æ´å“ªäº›æª”æ¡ˆæ ¼å¼?

A: CSV å’Œ TXTï¼ˆéƒ½æŒ‰ CSV è§£æï¼‰ã€‚Excel éœ€è½‰ CSVã€‚

### Q: æª”æ¡ˆå¤§å°é™åˆ¶?

A: ç›®å‰ç„¡é™åˆ¶ï¼Œä½† > 10MB å¯èƒ½å¾ˆæ…¢ã€‚

### Q: å¯ä»¥é è¨­åƒæ•¸å—?

A: å¦ï¼Œåƒæ•¸åœ¨ PeakDetectionControl ä¸­è¨­ç½®ï¼ˆå¾…é–‹ç™¼ï¼‰ã€‚

---

## âœ… æª¢æŸ¥æ¸…å–®

- [x] SpectrumUploader.jsx å®Œæˆ
- [x] SpectrumUploader.css å®Œæˆ
- [x] é›†æˆåˆ° App.jsx
- [x] å°å…¥ csvParser å‡½æ•¸
- [x] Zustand é€£æ¥
- [x] éŒ¯èª¤è™•ç†
- [ ] å–®å…ƒæ¸¬è©¦ï¼ˆå¾…ï¼‰
- [ ] æˆªåœ–/æ¼”ç¤ºï¼ˆå¾…ï¼‰

---

## ğŸ‰ ä¸‹ä¸€å€‹å…ƒä»¶

ç¾åœ¨å¯ä»¥é–‹ç™¼ï¼š

1. **PeakDetectionControl** - æ§åˆ¶åƒæ•¸å’ŒåŸ·è¡Œ
2. **SpectrumChart** - Plotly åœ–è¡¨å¯è¦–åŒ–
3. **StatusBar** - ç‹€æ…‹å’Œçµ±è¨ˆä¿¡æ¯

---

## ğŸ“š ç›¸é—œæª”æ¡ˆ

- `csvParser.js` - CSV è§£æé‚è¼¯
- `appStore.js` - Zustand ç‹€æ…‹
- `App.jsx` - ä¸»æ‡‰ç”¨æ¡†æ¶
- `App.css` - å…¨å±€æ¨£å¼
- `UI_DESIGN.md` - UI è¨­è¨ˆè¦åŠƒ

---

**SpectrumUploader å…ƒä»¶å·²å®Œæˆï¼** âœ¨

å¯ä»¥é–‹å§‹æ¸¬è©¦äº†ã€‚æœ‰ä»»ä½•å•é¡Œæˆ–éœ€è¦æ”¹é€²ï¼Œå‘Šè¨´æˆ‘ï¼
